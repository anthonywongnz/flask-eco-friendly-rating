{% extends "base.html" %}

{% block title %} Dashboard {% endblock %}

{% include "header.html" %}


{% block body %}

{% with messages = get_flashed_messages() %}
  {% if messages %}
    <ul class=flashes>
    {% for message in messages %}
      <li>{{ message }}</li>
    {% endfor %}
    </ul>
  {% endif %}
{% endwith %}


<h1>Blah blah blah</h1>

<table class="table table-light">
    <tr>
        <!-- <th>id</th> -->
        <!-- <th>rev</th> -->
        <th>Store Name</th>
        <th>Category</th>
        <th>Environmental Commitment</th>
        <th>Delivery</th>
        <th>Pickup</th>
        <th>Sussit Rating</th>
        <th>Action</th>
    </tr>
    {%for store in all_stores%}
        <tr>
            <!-- <td>{{store['_id']}}</td> -->
            <!-- <td>{{store['_rev']}}</td> -->
            <td>{{store['name']}}</td>
            <td>{{store['category']}}</td>
            <td>{{store['environmental_commitment']}}</td>
            <td>{{store.operations.delivery}}</td>
            <td>{{store.operations.pickup}}</td>
            <td>{{store.calculated_eco_score}}</td>
            <td>
                <a href="#modaledit{{store._id}}" class="btn btn-primary btn-xs" data-bs-toggle="modal">Edit</a>
                <a href="./delete?_id={{ store._id }}"><button type="submit" class="btn btn-primary btn-xs" onclick="return confirm('Are You Sure To Delete ?')">Delete</button></a>
            </td>
        </tr>

        <div id="modaledit{{store._id}}" class="modal fade" role="dialog">
          <div class="modal-dialog">
             <div class="modal-content">
                <div class="modal-header">
                   <h4 class="modal-title">Update Information</h4>
                </div>
                <div class="modal-body">
                   <form action="{{url_for('update')}}" method="POST">
                      <div class="form-group">
                         <label>Store Name:</label>
                          <input type="hidden"  name="id" value="{{store._id}}">
                          <input type="hidden"  name="rev" value="{{store._rev}}">
                         <input type="text" class="form-control" name="name" value="{{store.name}}">
                      </div>
                      <div class="form-group">
                         <label>Category:</label>
                         <input type="text" class="form-control" name="category" value="{{store.category}}">
                      </div>
                      <div class="form-group">
                         <label>Environmental Commitment:</label>
                         <input type="text" class="form-control" name="environmental_commitment" value="{{store.environmental_commitment}}">
                      </div>
                      <div class="form-group">
                        <label>Delivery:</label>
                        <input type="text" class="form-control" name="delivery" value="{{store.operations.delivery}}">
                     </div>
                     <div class="form-group">
                        <label>Pickup:</label>
                        <input type="text" class="form-control" name="pickup" value="{{store.operations.pickup}}">
                     </div>
                      <div class="form-group">
                         <button class="btn btn-primary" type="submit">Update</button>
                      </div>
                   </form>
                </div>
                <div class="modal-footer">
                   <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
             </div>
          </div>
       </div>

    {% endfor %}
</table>

<a href="#myModal" class="btn btn-lg btn-primary" data-bs-toggle="modal">Add New Restaurant...</a>

<div id="mymodal" class="modal fade" role="dialog">
  <div class="modal-dialog">
     <div class="modal-content">
        <div class="modal-header">
           <h4 class="modal-title">Add Restaurant</h4>
        </div>
        <div class="modal-body">
           <form action="{{url_for('insert')}}" method="POST">
               <div class="form-group">
                 <label>Store Name:</label>
                 <input type="text" class="form-control" name="name" required="1">
               </div>
               <div class="form-group">
                 <label>Category:</label>
                 <input type="text" class="form-control" name="category" required="1">
               </div>
               <div class="form-group">
                  <label>Environmental Commitment:</label>
                  <input type="text" class="form-control" name="environmental_commitment" required="1">
               </div>
               <div class="form-group">
                 <label>Delivery:</label>
                 <input type="text" class="form-control" name="delivery" required="1">
               </div>
               <div>
                 <label>Pickup:</label>
                 <input type="text" class="form-control" name="pickup" required="1">
               </div>
               <div class="form-group">
                 <button class="btn btn-primary" type="submit">Add Restaurant</button>
               </div>
           </form>
        </div>
        <div class="modal-footer">
           <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
     </div>
  </div>
</div>

{% endblock %}